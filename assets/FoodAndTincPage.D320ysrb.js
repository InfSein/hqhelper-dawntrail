import{d as A,W as V,X as T,e as U,c as v,S as i,R as _,o as m,a as l,F as M,Y as $,Q as t,k as S,U as y,P,V as W,r as j,w as D,q as L,y as G,Z as X}from"./vendor.Bn-7_sVg.js";import{R as H}from"./RouterCard.4EuP17xZ.js";import{u as J,F as Q,_ as Y,a as q,b as Z,c as K,d as z,g as ee,e as O,f as te,h as oe,M as ae,i as ne,H as F}from"./index.Cask5RuP.js";import{I as R,S as se}from"./StatisticsPanel.PdE0uZBz.js";import{a2 as ie,p as le,ae as ce}from"./icons.BPYJy1hK.js";import"./CraftStatistics.B9m63Ejw.js";const re={class:"card-title-text"},de={class:"item-selection-container"},ue={class:"card-title"},_e={class:"title"};const me={class:"item-btn-container"},fe={class:"card-title"},pe={class:"title"};const he={class:"item-btn-container"},ve={class:"actions"},ke=A({__name:"ItemSelectionPanel",props:{patch:{required:!0},patchModifiers:{},itemSelected:{required:!0},itemSelectedModifiers:{}},emits:V(["joinWorkflow"],["update:patch","update:itemSelected"]),setup(b,{emit:k}){const s=S("t"),g=T(b,"patch"),u=T(b,"itemSelected"),x=k,{getFoodAndTincs_v2:C}=J(),a=U(()=>C()),B=()=>{for(const c in u.value)u.value[c]=0},N=c=>c.replace("LEVELING",s("common.quoted_leveling")),w=()=>{x("joinWorkflow")},h=c=>{const r=[];c.forEach(e=>{let o="";o+=`[img]${e.iconUrl}[/img]	`,o+=e.name_zh,o+=`[size=70%][color=gray]${e.name_ja} / ${e.name_en}[/color][/size]	`;const p=[];e.craftRequires.forEach(n=>{const f=ee(n.id).name_zh;p.push(`${f}x${n.count}`)}),o+=p.join("ã€"),r.push(o)}),console.log(r.join(`
`))};return(c,r)=>{const e=K,o=Z,p=Y;return m(),v("div",null,[i(Q,{"card-key":"ft-item-selection"},{header:_(()=>[r[1]||(r[1]=l("i",{class:"xiv square-1"},null,-1)),l("span",re,y(t(s)("ft_helper.select_food_and_tinc")),1)]),default:_(()=>[i(p,{value:g.value,"onUpdate:value":r[0]||(r[0]=n=>g.value=n),type:"line",animated:""},{default:_(()=>[(m(!0),v(M,null,$(t(a),(n,f)=>(m(),P(o,{key:"foodAndTincs-"+f,name:f,tab:t(s)("common.patch_x",N(f)),disabled:!n.count},{default:_(()=>[l("div",de,[i(e,{size:"small"},{header:_(()=>[l("div",ue,[i(z,{size:16,src:"./image/game-job/companion/culinarian.png"}),l("span",_e,y(t(s)("common.food")),1),W("",!0)])]),default:_(()=>[l("div",me,[(m(!0),v(M,null,$(n.foods,(d,E)=>(m(),P(R,{class:"item",key:`food-${f}-${E}`,"item-info":d,value:u.value[d.id],"onUpdate:value":I=>u.value[d.id]=I},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1024),i(e,{size:"small"},{header:_(()=>[l("div",fe,[i(z,{size:16,src:"./image/game-job/companion/alchemist.png"}),l("span",pe,y(t(s)("common.medicine")),1),W("",!0)])]),default:_(()=>[l("div",he,[(m(!0),v(M,null,$(n.tincs,(d,E)=>(m(),P(R,{class:"item",key:`tinc-${f}-${E}`,"item-info":d,value:u.value[d.id],"onUpdate:value":I=>u.value[d.id]=I},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1024)])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),l("div",ve,[i(q,{icon:t(ie),text:t(s)("workflow.text.join_in_workflow"),tip:t(s)("workflow.text.join_selected_food_and_tinc_in_workflow"),onClick:w},null,8,["icon","text","tip"]),i(q,{icon:t(le),text:t(s)("common.clear"),tip:t(s)("ft_helper.tooltip.clear_selected"),onClick:B},null,8,["icon","text","tip"])])]),_:1})])}}}),ge=O(ke,[["__scopeId","data-v-b94ab590"]]),we={id:"main-container"},Se={id:"left-layout"},be={id:"right-layout"},xe=A({__name:"FoodAndTincPage",setup(b){const k=S("t"),s=S("userConfig"),g=S("appMode")??j(""),u=te(),x=oe(),{calItems:C}=J(),a=j({patch:"7.2",hidePrecraftMaterials:!1,itemSelected:{}});if(!(s.value.disable_workstate_cache??!1)){const e=s.value.fthelper_cache_work_state;e&&JSON.stringify(e).length>2&&(a.value=e,a.value.hidePrecraftMaterials??=e?.hidePrecraftGatherings||!1),D(a,async()=>{if(a.value&&s)try{await Promise.resolve(),s.value.fthelper_cache_work_state=a.value,u.setUserConfig(s.value)}catch(o){console.error("Error handling workState change:",o)}else console.warn("workState or userConfig is not defined")},{deep:!0})}(()=>{F.meals.forEach(e=>{a.value.itemSelected[e]===void 0&&(a.value.itemSelected[e]=0)}),F.medicines.forEach(e=>{a.value.itemSelected[e]===void 0&&(a.value.itemSelected[e]=0)})})();const w=U(()=>C(a.value.itemSelected)),h=j(!1),c=U(()=>{const e={};return Object.values(w.value.ls).forEach(o=>{e[o.id]=o.need}),e}),r=()=>{if(!Object.values(c.value).length){x.error(k("workflow.join_in_workflow.message.no_food_tinc"));return}h.value=!0};return(e,o)=>{const p=ne;return m(),v("div",we,[L(i(H,{id:"router-card","page-name":t(k)("common.appfunc.cal_food_and_tinc"),"page-icon":t(ce)},null,8,["page-name","page-icon"]),[[G,t(g)!=="overlay"]]),l("div",Se,[i(ge,{patch:t(a).patch,"onUpdate:patch":o[0]||(o[0]=n=>t(a).patch=n),"item-selected":t(a).itemSelected,"onUpdate:itemSelected":o[1]||(o[1]=n=>t(a).itemSelected=n),onJoinWorkflow:r},null,8,["patch","item-selected"])]),l("div",be,[i(se,{"hide-precraft-materials":t(a).hidePrecraftMaterials,"onUpdate:hidePrecraftMaterials":o[2]||(o[2]=n=>t(a).hidePrecraftMaterials=n),statistics:t(w),"item-selected":t(a).itemSelected},null,8,["hide-precraft-materials","statistics","item-selected"])]),i(ae,{show:t(h),"onUpdate:show":o[3]||(o[3]=n=>X(h)?h.value=n:null),items:t(c)},null,8,["show","items"]),i(p)])}}}),Pe=O(xe,[["__scopeId","data-v-d17c6dcb"]]);export{Pe as default};
