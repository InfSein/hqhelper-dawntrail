import{d as O,W as D,X as z,e as B,c as v,U as n,R as m,o as f,a as l,F as $,Y as y,P,L as W,Q as e,k as g,S as q,V as j,r as U,w as G,q as X,y as H,Z as Q}from"./vendor.DaGD8wRy.js";import{R as Y}from"./RouterCard.OOhqkaAW.js";import{u as V,F as Z,_ as K,a as ee,b as F,c as te,d as J,g as oe,e as L,f as ae,h as se,M as ne,i as ie,H as R}from"./index.CG8fR3B8.js";import{I as A,S as le}from"./StatisticsPanel.Dzb8e6IJ.js";import{J as ce,p as re,ad as de}from"./icons.BN6_TYLH.js";import"./CraftStatistics.V_MVglOb.js";const ue={class:"card-title-text"},_e={class:"item-selection-container"},me={class:"card-title"},fe={class:"title"};const pe={class:"item-btn-container"},he={class:"card-title"},ve={class:"title"};const ge={class:"item-btn-container"},ke={class:"actions"},we=O({__name:"ItemSelectionPanel",props:{patch:{required:!0},patchModifiers:{},itemSelected:{required:!0},itemSelectedModifiers:{}},emits:D(["joinWorkflow"],["update:patch","update:itemSelected"]),setup(C,{emit:k}){const s=g("t"),w=g("userConfig"),S=z(C,"patch"),d=z(C,"itemSelected"),x=k,{getFoodAndTincs_v2:a}=V(),N=B(()=>a()),T=()=>{for(const u in d.value)d.value[u]=0},b=u=>u.replace("LEVELING",s("common.quoted_leveling")),h=()=>{x("joinWorkflow")},E=u=>{const t=[];u.forEach(o=>{let c="";c+=`[img]${o.iconUrl}[/img]	`,c+=o.name_zh,c+=`[size=70%][color=gray]${o.name_ja} / ${o.name_en}[/color][/size]	`;const i=[];o.craftRequires.forEach(_=>{const p=oe(_.id).name_zh;i.push(`${p}x${_.count}`)}),c+=i.join("ã€"),t.push(c)}),console.log(t.join(`
`))};return(u,t)=>{const o=ee,c=te,i=K;return f(),v("div",null,[n(Z,{"card-key":"ft-item-selection"},{header:m(()=>[t[1]||(t[1]=l("i",{class:"xiv square-1"},null,-1)),l("span",ue,j(e(s)("ft_helper.select_food_and_tinc")),1)]),default:m(()=>[n(i,{value:S.value,"onUpdate:value":t[0]||(t[0]=_=>S.value=_),type:"line",animated:""},{default:m(()=>[(f(!0),v($,null,y(e(N),(_,p)=>(f(),P(c,{key:"foodAndTincs-"+p,name:p,tab:e(s)("common.patch_x",b(p)),disabled:!_.count},{default:m(()=>[l("div",_e,[n(o,{size:"small",class:W(e(w).custom_background?"glasscard smallcard":"")},{header:m(()=>[l("div",me,[n(F,{size:16,src:"./image/game-job/companion/culinarian.png"}),l("span",fe,j(e(s)("common.food")),1),q("",!0)])]),default:m(()=>[l("div",pe,[(f(!0),v($,null,y(_.foods,(r,I)=>(f(),P(A,{class:"item",key:`food-${p}-${I}`,"item-info":r,value:d.value[r.id],"onUpdate:value":M=>d.value[r.id]=M},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1032,["class"]),n(o,{size:"small",class:W(e(w).custom_background?"glasscard smallcard":"")},{header:m(()=>[l("div",he,[n(F,{size:16,src:"./image/game-job/companion/alchemist.png"}),l("span",ve,j(e(s)("common.medicine")),1),q("",!0)])]),default:m(()=>[l("div",ge,[(f(!0),v($,null,y(_.tincs,(r,I)=>(f(),P(A,{class:"item",key:`tinc-${p}-${I}`,"item-info":r,value:d.value[r.id],"onUpdate:value":M=>d.value[r.id]=M},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1032,["class"])])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),l("div",ke,[n(J,{icon:e(ce),text:e(s)("workflow.text.join_in_workflow"),tip:e(s)("workflow.text.join_selected_food_and_tinc_in_workflow"),onClick:h},null,8,["icon","text","tip"]),n(J,{icon:e(re),text:e(s)("common.clear"),tip:e(s)("ft_helper.tooltip.clear_selected"),onClick:T},null,8,["icon","text","tip"])])]),_:1})])}}}),Se=L(we,[["__scopeId","data-v-70d54541"]]),be={id:"main-container"},Ce={id:"left-layout"},xe={id:"right-layout"},Ee=O({__name:"FoodAndTincPage",setup(C){const k=g("t"),s=g("userConfig"),w=g("appMode")??U(""),S=ae(),d=se(),{calItems:x}=V(),a=U({patch:"7.2",hidePrecraftMaterials:!1,itemSelected:{}});if(!(s.value.disable_workstate_cache??!1)){const t=s.value.fthelper_cache_work_state;t&&JSON.stringify(t).length>2&&(a.value=t,a.value.hidePrecraftMaterials??=t?.hidePrecraftGatherings||!1),G(a,async()=>{if(a.value&&s)try{await Promise.resolve(),s.value.fthelper_cache_work_state=a.value,S.setUserConfig(s.value)}catch(o){console.error("Error handling workState change:",o)}else console.warn("workState or userConfig is not defined")},{deep:!0})}(()=>{R.meals.forEach(t=>{a.value.itemSelected[t]===void 0&&(a.value.itemSelected[t]=0)}),R.medicines.forEach(t=>{a.value.itemSelected[t]===void 0&&(a.value.itemSelected[t]=0)})})();const b=B(()=>x(a.value.itemSelected)),h=U(!1),E=B(()=>{const t={};return Object.values(b.value.ls).forEach(o=>{t[o.id]=o.need}),t}),u=()=>{if(!Object.values(E.value).length){d.error(k("workflow.join_in_workflow.message.no_food_tinc"));return}h.value=!0};return(t,o)=>{const c=ie;return f(),v("div",be,[X(n(Y,{id:"router-card","page-name":e(k)("common.appfunc.cal_food_and_tinc"),"page-icon":e(de)},null,8,["page-name","page-icon"]),[[H,e(w)!=="overlay"]]),l("div",Ce,[n(Se,{patch:e(a).patch,"onUpdate:patch":o[0]||(o[0]=i=>e(a).patch=i),"item-selected":e(a).itemSelected,"onUpdate:itemSelected":o[1]||(o[1]=i=>e(a).itemSelected=i),onJoinWorkflow:u},null,8,["patch","item-selected"])]),l("div",xe,[n(le,{"hide-precraft-materials":e(a).hidePrecraftMaterials,"onUpdate:hidePrecraftMaterials":o[2]||(o[2]=i=>e(a).hidePrecraftMaterials=i),statistics:e(b),"item-selected":e(a).itemSelected},null,8,["hide-precraft-materials","statistics","item-selected"])]),n(ne,{show:e(h),"onUpdate:show":o[3]||(o[3]=i=>Q(h)?h.value=i:null),items:e(E)},null,8,["show","items"]),n(c)])}}}),Ue=L(Ee,[["__scopeId","data-v-d17c6dcb"]]);export{Ue as default};
