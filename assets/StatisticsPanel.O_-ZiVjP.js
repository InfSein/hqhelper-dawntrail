import{r as R,S as L,f as B,h as O,i as T,s as $,t as G,_ as Q,v as W,w as X,x as Z,y as H,z as J,A as K,B as Y}from"./index.DIpgTaJR.js";import{d as A,W as E,k as S,r as f,X as k,c as U,o as q,U as i,Q as e,e as P,R as y,a as l,V as g,x,Z as I,N as ee}from"./vendor.DOOPojup.js";import{C as te}from"./CraftStatistics.CxK9Etq4.js";const se={class:"item-selector"},ae=A({__name:"ItemStepper",props:E({itemInfo:{type:Object,required:!0}},{value:{required:!0},valueModifiers:{}}),emits:["update:value"],setup(c){const s=S("isMobile")??f(!1),p=k(c,"value");return(u,m)=>(q(),U("div",se,[i(R,{class:"item-button","item-info":c.itemInfo,"show-icon":"","show-name":"","btn-height":30,"pop-use-custom-width":"","pop-custom-width":e(s)?300:void 0},null,8,["item-info","pop-custom-width"]),i(L,{class:"item-stepper",value:p.value,"onUpdate:value":m[0]||(m[0]=C=>p.value=C)},null,8,["value"])]))}}),me=B(ae,[["__scopeId","data-v-14be2278"]]),oe={class:"card-title-text"},ie=["disabled"],ne={class:"pre"},re={class:"preset-item"},le=A({__name:"StatisticsPanel",props:E({itemSelected:{},statistics:{}},{hidePrecraftMaterials:{type:Boolean,required:!0},hidePrecraftMaterialsModifiers:{}}),emits:["update:hidePrecraftMaterials"],setup(c){const s=S("t"),p=S("userConfig"),u=S("funcConfig"),m=O(),{alertError:C}=Y(s),j=T(),{getStatementData:D}=$(p,u,s),N=c,M=k(c,"hidePrecraftMaterials"),v=f(!1),_=f(!1),F=()=>{u.value.use_traditional_statement?v.value=!0:_.value=!0},n=P(()=>D(N.statistics)),h=f(!1),b=P(()=>G(u.value,n.value)),d=f(!1),V=async()=>{if(b.value.updateRequired){d.value=!0;try{const o=[];n.value.craftTargets.forEach(r=>{o.push(r.id)}),n.value.materialsLvBase.forEach(r=>{o.push(r.id)});const t=await J([...new Set(o)],u.value.universalis_server),w=u.value;Object.keys(t).forEach(r=>{const a=Number(r);w.cache_item_prices[a]=t[a]}),await m.setFuncConfig(K(w,m.userConfig))}catch(o){console.error(o),await C(s("common.message.get_price_failed")+`
`+(o?.message??o))}d.value=!1}},z=async()=>{if(d.value){j.info(s("common.loading"));return}await V(),h.value=!0};return(o,t)=>{const w=W,r=Q;return q(),U("div",null,[i(r,{"card-key":"ft-statistics"},{header:y(()=>[t[4]||(t[4]=l("i",{class:"xiv square-2"},null,-1)),l("span",oe,g(e(s)("statistics.view_statistics")),1),l("a",{class:"card-title-extra",href:"javascript:void(0);",onClick:F},g(e(s)("common.mquoted_view_statement")),1),l("a",{class:"card-title-extra",href:"javascript:void(0);",disabled:e(d),style:ee(e(d)?"cursor: not-allowed; color: gray;":"cursor: pointer;"),onClick:z},"["+g(e(d)?e(s)("common.loading"):e(s)("statistics.group.cost_and_benefit.title"))+"]",13,ie)]),default:y(()=>[l("div",ne,[l("div",re,[i(w,{value:M.value,"onUpdate:value":t[0]||(t[0]=a=>M.value=a),round:!1,size:"small"},null,8,["value"]),l("div",null,g(e(s)("statistics.preference.show_direct_materials_only")),1)])]),i(te,{"item-selected":c.itemSelected,"hide-precraft-materials":M.value},null,8,["item-selected","hide-precraft-materials"]),i(X,x({show:e(v),"onUpdate:show":t[1]||(t[1]=a=>I(v)?v.value=a:null)},e(n)),null,16,["show"]),i(Z,x({show:e(_),"onUpdate:show":t[2]||(t[2]=a=>I(_)?_.value=a:null)},e(n)),null,16,["show"]),i(H,{show:e(h),"onUpdate:show":t[3]||(t[3]=a=>I(h)?h.value=a:null),"cost-items":e(n).materialsLvBase,"benefit-items":e(n).craftTargets,"cost-info":e(b).costInfo,"benefit-info":e(b).benefitInfo},null,8,["show","cost-items","benefit-items","cost-info","benefit-info"])]),_:1})])}}}),fe=B(le,[["__scopeId","data-v-19bc4799"]]);export{me as I,fe as S};
