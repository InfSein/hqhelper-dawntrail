import{d as V,W as G,X as W,e as N,c as v,U as n,R as _,o as m,a as l,F as j,Y as y,P,L as q,Q as e,k as g,S as J,V as U,r as B,w as X,q as H,y as Q,Z as Y}from"./vendor.DOOPojup.js";import{R as Z}from"./RouterCard.Cx2UkE-r.js";import{u as L,_ as K,a as ee,b as te,c as R,d as oe,e as A,g as ae,f as D,h as se,i as ne,M as ie,j as le,H as F}from"./index.DIpgTaJR.js";import{I as O,S as ce}from"./StatisticsPanel.O_-ZiVjP.js";import{J as re,p as de,ad as ue}from"./icons._F9tMcs6.js";import"./CraftStatistics.CxK9Etq4.js";const _e={class:"card-title-text"},me={class:"item-selection-container"},fe={class:"card-title"},pe={class:"title"};const he={class:"item-btn-container"},ve={class:"card-title"},ge={class:"title"};const ke={class:"item-btn-container"},we={class:"actions"},Se=V({__name:"ItemSelectionPanel",props:{patch:{required:!0},patchModifiers:{},itemSelected:{required:!0},itemSelectedModifiers:{}},emits:G(["joinWorkflow"],["update:patch","update:itemSelected"]),setup(x,{emit:k}){const s=g("t"),w=g("userConfig"),S=W(x,"patch"),d=W(x,"itemSelected"),E=k,{getFoodAndTincs_v2:a}=L(),T=N(()=>a()),z=()=>{for(const u in d.value)d.value[u]=0},b=u=>u.replace("LEVELING",s("common.quoted_leveling")),p=()=>{E("joinWorkflow")},I=u=>{const t=[];u.forEach(o=>{let c="";c+=`[img]${o.iconUrl}[/img]	`,c+=o.name_zh,c+=`[size=70%][color=gray]${o.name_ja} / ${o.name_en}[/color][/size]	`;const i=[];o.craftRequires.forEach(C=>{const f=ae(C.id).name_zh;i.push(`${f}x${C.count}`)}),c+=i.join("ã€"),t.push(c)}),console.log(t.join(`
`))};return(u,t)=>{const o=te,c=oe,i=ee,C=K;return m(),v("div",null,[n(C,{"card-key":"ft-item-selection"},{header:_(()=>[t[1]||(t[1]=l("i",{class:"xiv square-1"},null,-1)),l("span",_e,U(e(s)("ft_helper.select_food_and_tinc")),1)]),default:_(()=>[n(i,{value:S.value,"onUpdate:value":t[0]||(t[0]=f=>S.value=f),type:"line",animated:""},{default:_(()=>[(m(!0),v(j,null,y(e(T),(f,h)=>(m(),P(c,{key:"foodAndTincs-"+h,name:h,tab:e(s)("common.patch_x",b(h)),disabled:!f.count},{default:_(()=>[l("div",me,[n(o,{size:"small",class:q(e(w).custom_background?"glasscard smallcard":"")},{header:_(()=>[l("div",fe,[n(R,{size:16,src:"./image/game-job/companion/culinarian.png"}),l("span",pe,U(e(s)("common.food")),1),J("",!0)])]),default:_(()=>[l("div",he,[(m(!0),v(j,null,y(f.foods,(r,$)=>(m(),P(O,{class:"item",key:`food-${h}-${$}`,"item-info":r,value:d.value[r.id],"onUpdate:value":M=>d.value[r.id]=M},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1032,["class"]),n(o,{size:"small",class:q(e(w).custom_background?"glasscard smallcard":"")},{header:_(()=>[l("div",ve,[n(R,{size:16,src:"./image/game-job/companion/alchemist.png"}),l("span",ge,U(e(s)("common.medicine")),1),J("",!0)])]),default:_(()=>[l("div",ke,[(m(!0),v(j,null,y(f.tincs,(r,$)=>(m(),P(O,{class:"item",key:`tinc-${h}-${$}`,"item-info":r,value:d.value[r.id],"onUpdate:value":M=>d.value[r.id]=M},null,8,["item-info","value","onUpdate:value"]))),128))])]),_:2},1032,["class"])])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),l("div",we,[n(A,{icon:e(re),text:e(s)("workflow.text.join_in_workflow"),tip:e(s)("workflow.text.join_selected_food_and_tinc_in_workflow"),onClick:p},null,8,["icon","text","tip"]),n(A,{icon:e(de),text:e(s)("common.clear"),tip:e(s)("ft_helper.tooltip.clear_selected"),onClick:z},null,8,["icon","text","tip"])])]),_:1})])}}}),be=D(Se,[["__scopeId","data-v-878ccda3"]]),Ce={id:"main-container"},xe={id:"left-layout"},Ee={id:"right-layout"},Ie=V({__name:"FoodAndTincPage",setup(x){const k=g("t"),s=g("userConfig"),w=g("appMode")??B(""),S=se(),d=ne(),{calItems:E}=L(),a=B({patch:"7.4",hidePrecraftMaterials:!1,itemSelected:{}});if(!(s.value.disable_workstate_cache??!1)){const t=s.value.fthelper_cache_work_state;t&&JSON.stringify(t).length>2&&(a.value=t,a.value.hidePrecraftMaterials??=t?.hidePrecraftGatherings||!1),X(a,async()=>{if(a.value&&s)try{await Promise.resolve(),s.value.fthelper_cache_work_state=a.value,S.setUserConfig(s.value)}catch(o){console.error("Error handling workState change:",o)}else console.warn("workState or userConfig is not defined")},{deep:!0})}(()=>{F.meals.forEach(t=>{a.value.itemSelected[t]===void 0&&(a.value.itemSelected[t]=0)}),F.medicines.forEach(t=>{a.value.itemSelected[t]===void 0&&(a.value.itemSelected[t]=0)})})();const b=N(()=>E(a.value.itemSelected)),p=B(!1),I=N(()=>{const t={};return Object.values(b.value.ls).forEach(o=>{t[o.id]=o.need}),t}),u=()=>{if(!Object.values(I.value).length){d.error(k("workflow.join_in_workflow.message.no_food_tinc"));return}p.value=!0};return(t,o)=>{const c=le;return m(),v("div",Ce,[H(n(Z,{id:"router-card","page-name":e(k)("common.appfunc.cal_food_and_tinc"),"page-icon":e(ue)},null,8,["page-name","page-icon"]),[[Q,e(w)!=="overlay"]]),l("div",xe,[n(be,{patch:e(a).patch,"onUpdate:patch":o[0]||(o[0]=i=>e(a).patch=i),"item-selected":e(a).itemSelected,"onUpdate:itemSelected":o[1]||(o[1]=i=>e(a).itemSelected=i),onJoinWorkflow:u},null,8,["patch","item-selected"])]),l("div",Ee,[n(ce,{"hide-precraft-materials":e(a).hidePrecraftMaterials,"onUpdate:hidePrecraftMaterials":o[2]||(o[2]=i=>e(a).hidePrecraftMaterials=i),statistics:e(b),"item-selected":e(a).itemSelected},null,8,["hide-precraft-materials","statistics","item-selected"])]),n(ie,{show:e(p),"onUpdate:show":o[3]||(o[3]=i=>Y(p)?p.value=i:null),items:e(I)},null,8,["show","items"]),n(c)])}}}),Be=D(Ie,[["__scopeId","data-v-abcd873d"]]);export{Be as default};
